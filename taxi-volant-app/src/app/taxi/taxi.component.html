<app-sidebar></app-sidebar>
<div class="container">
  <app-navbar></app-navbar>
  <div class="centered-content">
    <button class="btn btn-primary add-taxi-button" (click)="openPopup()">Ajouter un Taxi</button>

    <h2 class="mt-4">Liste des Taxis</h2>
    <table class="table table-striped table-bordered mt-3">
      <thead class="thead-dark">
        <tr>
          <th>Nom</th>
          <th>Matricule</th>
          <th>Prix</th>
          <th>Photo</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let taxi of taxis">
          <td>{{ taxi.nom }}</td>
          <td>{{ taxi.matricule }}</td>
          <td>{{ taxi.prix }} DT</td>
          <td>
            <img [src]="taxi.photo_de_taxi" alt="Photo du taxi" class="taxi-photo" *ngIf="taxi.photo_de_taxi">
          </td>
          <td>
            <button class="btn btn-info" (click)="openViewPopup(taxi)">Voir</button>
            <button class="btn btn-warning" (click)="openEditPopup(taxi)">Modifier</button>
            <button class="btn btn-danger" (click)="deleteTaxi(taxi.id)">Supprimer</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Popup d'ajout de taxi -->
<div class="popup" *ngIf="isPopupOpen" (click)="closePopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="closePopup()">X</button>
    <h2>Ajouter un Taxi</h2>
    <form (ngSubmit)="addTaxi()">
      <div class="form-group">
        <label for="nom">Nom</label>
        <select id="nom" class="form-control" [(ngModel)]="newTaxi.nom" name="nom" required>
          <option value="BMW">BMW</option>
          <option value="MERCEDES">MERCEDES</option>
          <option value="AUDI">AUDI</option>
          <!-- Add other options here -->
        </select>
      </div>
      <div class="form-group">
        <label for="matricule">Matricule</label>
        <input type="text" id="matricule" class="form-control" [(ngModel)]="newTaxi.matricule" name="matricule" required>
      </div>
      <div class="form-group">
        <label for="prix">Prix</label>
        <input type="number" id="prix" class="form-control" [(ngModel)]="newTaxi.prix" name="prix" required>
      </div>
      <div class="form-group">
        <label for="photo">Photo du taxi</label>
        <input type="file" id="photo" class="form-control" (change)="onFileSelected($event)">
      </div>
      <button type="submit" class="btn btn-success">Ajouter</button>
    </form>
  </div>
</div>


<!-- Popup de modification de taxi -->
<div class="popup" *ngIf="isEditPopupOpen" (click)="closeEditPopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="closeEditPopup()">X</button>
    <h2>Modifier un Taxi</h2>
    <form (ngSubmit)="updateTaxi()">
      <div class="form-group">
        <label for="edit-nom">Nom</label>
        <input type="text" id="edit-nom" class="form-control" [(ngModel)]="editTaxi.nom" name="editNom" required>
      </div>
      <div class="form-group">
        <label for="edit-matricule">Matricule</label>
        <input type="text" id="edit-matricule" class="form-control" [(ngModel)]="editTaxi.matricule" name="editMatricule" required>
      </div>
      <div class="form-group">
        <label for="edit-prix">Prix</label>
        <input type="number" id="edit-prix" class="form-control" [(ngModel)]="editTaxi.prix" name="editPrix" required>
      </div>
      <div class="form-group">
        <label for="edit-photo">Photo du taxi</label>
        <input type="file" id="edit-photo" class="form-control" (change)="onFileSelected($event)">
      </div>
      <button type="submit" class="btn btn-success">Enregistrer</button>
    </form>
  </div>
</div>

<!-- Popup de visualisation de taxi -->
<div class="popup" *ngIf="isViewPopupOpen" (click)="closeViewPopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="closeViewPopup()">X</button>
    <h2>DÃ©tails du Taxi</h2>
    <p><strong>Nom:</strong> {{ viewTaxi.nom }}</p>
    <p><strong>Matricule:</strong> {{ viewTaxi.matricule }}</p>
    <p><strong>Prix:</strong> {{ viewTaxi.prix }} DT</p>
    <img [src]="viewTaxi.photo_de_taxi" alt="Photo du taxi" class="taxi-photo" *ngIf="viewTaxi.photo_de_taxi">
  </div>
</div>
